{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = useDraggableControl;\nexports.draggableControlDefaultProps = exports.draggableControlPropTypes = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar PropTypes = _interopRequireWildcard(require(\"prop-types\"));\n\nvar _react = require(\"react\");\n\nvar _useMapControl = _interopRequireWildcard(require(\"./use-map-control\"));\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        (0, _defineProperty2[\"default\"])(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar draggableControlPropTypes = Object.assign({}, _useMapControl.mapControlPropTypes, {\n  draggable: PropTypes.bool,\n  onDrag: PropTypes.func,\n  onDragEnd: PropTypes.func,\n  onDragStart: PropTypes.func,\n  offsetLeft: PropTypes.number,\n  offsetTop: PropTypes.number\n});\nexports.draggableControlPropTypes = draggableControlPropTypes;\nvar draggableControlDefaultProps = Object.assign({}, _useMapControl.mapControlDefaultProps, {\n  draggable: false,\n  offsetLeft: 0,\n  offsetTop: 0\n});\nexports.draggableControlDefaultProps = draggableControlDefaultProps;\n\nfunction getDragEventPosition(event) {\n  var _event$offsetCenter = event.offsetCenter,\n      x = _event$offsetCenter.x,\n      y = _event$offsetCenter.y;\n  return [x, y];\n}\n\nfunction getDragEventOffset(event, container) {\n  var _event$center = event.center,\n      x = _event$center.x,\n      y = _event$center.y;\n\n  if (container) {\n    var rect = container.getBoundingClientRect();\n    return [rect.left - x, rect.top - y];\n  }\n\n  return null;\n}\n\nfunction getDragLngLat(dragPos, dragOffset, props, context) {\n  var x = dragPos[0] + dragOffset[0] - props.offsetLeft;\n  var y = dragPos[1] + dragOffset[1] - props.offsetTop;\n  return context.viewport.unproject([x, y]);\n}\n\nfunction onDragStart(event, _ref) {\n  var props = _ref.props,\n      callbacks = _ref.callbacks,\n      state = _ref.state,\n      context = _ref.context,\n      containerRef = _ref.containerRef;\n  var draggable = props.draggable;\n\n  if (!draggable) {\n    return;\n  }\n\n  event.stopPropagation();\n  var dragPos = getDragEventPosition(event);\n  var dragOffset = getDragEventOffset(event, containerRef.current);\n  state.setDragPos(dragPos);\n  state.setDragOffset(dragOffset);\n\n  if (callbacks.onDragStart && dragOffset) {\n    var callbackEvent = Object.assign({}, event);\n    callbackEvent.lngLat = getDragLngLat(dragPos, dragOffset, props, context);\n    callbacks.onDragStart(callbackEvent);\n  }\n}\n\nfunction onDrag(event, _ref2) {\n  var props = _ref2.props,\n      callbacks = _ref2.callbacks,\n      state = _ref2.state,\n      context = _ref2.context;\n  event.stopPropagation();\n  var dragPos = getDragEventPosition(event);\n  state.setDragPos(dragPos);\n  var dragOffset = state.dragOffset;\n\n  if (callbacks.onDrag && dragOffset) {\n    var callbackEvent = Object.assign({}, event);\n    callbackEvent.lngLat = getDragLngLat(dragPos, dragOffset, props, context);\n    callbacks.onDrag(callbackEvent);\n  }\n}\n\nfunction onDragEnd(event, _ref3) {\n  var props = _ref3.props,\n      callbacks = _ref3.callbacks,\n      state = _ref3.state,\n      context = _ref3.context;\n  event.stopPropagation();\n  var dragPos = state.dragPos,\n      dragOffset = state.dragOffset;\n  state.setDragPos(null);\n  state.setDragOffset(null);\n\n  if (callbacks.onDragEnd && dragPos && dragOffset) {\n    var callbackEvent = Object.assign({}, event);\n    callbackEvent.lngLat = getDragLngLat(dragPos, dragOffset, props, context);\n    callbacks.onDragEnd(callbackEvent);\n  }\n}\n\nfunction onDragCancel(event, _ref4) {\n  var state = _ref4.state;\n  event.stopPropagation();\n  state.setDragPos(null);\n  state.setDragOffset(null);\n}\n\nfunction registerEvents(thisRef) {\n  var eventManager = thisRef.context.eventManager;\n\n  if (!eventManager || !thisRef.state.dragPos) {\n    return undefined;\n  }\n\n  var events = {\n    panmove: function panmove(evt) {\n      return onDrag(evt, thisRef);\n    },\n    panend: function panend(evt) {\n      return onDragEnd(evt, thisRef);\n    },\n    pancancel: function pancancel(evt) {\n      return onDragCancel(evt, thisRef);\n    }\n  };\n  eventManager.watch(events);\n  return function () {\n    eventManager.off(events);\n  };\n}\n\nfunction useDraggableControl(props) {\n  var _useState = (0, _react.useState)(null),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      dragPos = _useState2[0],\n      setDragPos = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(null),\n      _useState4 = (0, _slicedToArray2[\"default\"])(_useState3, 2),\n      dragOffset = _useState4[0],\n      setDragOffset = _useState4[1];\n\n  var thisRef = (0, _useMapControl[\"default\"])(_objectSpread(_objectSpread({}, props), {}, {\n    onDragStart: onDragStart\n  }));\n  thisRef.callbacks = props;\n  thisRef.state.dragPos = dragPos;\n  thisRef.state.setDragPos = setDragPos;\n  thisRef.state.dragOffset = dragOffset;\n  thisRef.state.setDragOffset = setDragOffset;\n  (0, _react.useEffect)(function () {\n    return registerEvents(thisRef);\n  }, [thisRef.context.eventManager, Boolean(dragPos)]);\n  return thisRef;\n}","map":{"version":3,"sources":["D:\\Side Projects\\maptravelapp\\frontend\\node_modules\\react-map-gl\\src\\components\\draggable-control.js"],"names":["draggableControlPropTypes","mapControlPropTypes","draggable","PropTypes","onDrag","onDragEnd","onDragStart","offsetLeft","offsetTop","number","draggableControlDefaultProps","mapControlDefaultProps","x","y","event","rect","container","dragPos","dragOffset","props","context","callbacks","state","containerRef","getDragEventPosition","getDragEventOffset","callbackEvent","Object","getDragLngLat","eventManager","thisRef","events","panmove","panend","pancancel","onDragCancel","setDragPos","setDragOffset","registerEvents","Boolean"],"mappings":"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","sourcesContent":["// Copyright (c) 2015 Uber Technologies, Inc.\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport * as PropTypes from 'prop-types';\nimport {useState, useEffect} from 'react';\nimport useMapControl, {mapControlDefaultProps, mapControlPropTypes} from './use-map-control';\n\nexport const draggableControlPropTypes = Object.assign({}, mapControlPropTypes, {\n  draggable: PropTypes.bool,\n  onDrag: PropTypes.func,\n  onDragEnd: PropTypes.func,\n  onDragStart: PropTypes.func,\n  // Offset from the left\n  offsetLeft: PropTypes.number,\n  // Offset from the top\n  offsetTop: PropTypes.number\n});\n\nexport const draggableControlDefaultProps = Object.assign({}, mapControlDefaultProps, {\n  draggable: false,\n  offsetLeft: 0,\n  offsetTop: 0\n});\n\nfunction getDragEventPosition(event) {\n  const {\n    offsetCenter: {x, y}\n  } = event;\n  return [x, y];\n}\n\n/**\n * Returns offset of top-left of marker from drag start event\n * (used for positioning marker relative to next mouse coordinates)\n */\nfunction getDragEventOffset(event, container) {\n  const {\n    center: {x, y}\n  } = event;\n  if (container) {\n    const rect = container.getBoundingClientRect();\n    return [rect.left - x, rect.top - y];\n  }\n  return null;\n}\n\nfunction getDragLngLat(dragPos, dragOffset, props, context) {\n  const x = dragPos[0] + dragOffset[0] - props.offsetLeft;\n  const y = dragPos[1] + dragOffset[1] - props.offsetTop;\n  // Unproject x/y value while respecting offset coordinates\n  return context.viewport.unproject([x, y]);\n}\n\nfunction onDragStart(event, {props, callbacks, state, context, containerRef}) {\n  const {draggable} = props;\n  if (!draggable) {\n    return;\n  }\n  event.stopPropagation();\n\n  const dragPos = getDragEventPosition(event);\n  const dragOffset = getDragEventOffset(event, containerRef.current);\n  state.setDragPos(dragPos);\n  state.setDragOffset(dragOffset);\n\n  if (callbacks.onDragStart && dragOffset) {\n    const callbackEvent = Object.assign({}, event);\n    callbackEvent.lngLat = getDragLngLat(dragPos, dragOffset, props, context);\n    callbacks.onDragStart(callbackEvent);\n  }\n}\n\nfunction onDrag(event, {props, callbacks, state, context}) {\n  event.stopPropagation();\n\n  const dragPos = getDragEventPosition(event);\n  state.setDragPos(dragPos);\n\n  const {dragOffset} = state;\n  if (callbacks.onDrag && dragOffset) {\n    const callbackEvent = Object.assign({}, event);\n    callbackEvent.lngLat = getDragLngLat(dragPos, dragOffset, props, context);\n    callbacks.onDrag(callbackEvent);\n  }\n}\n\nfunction onDragEnd(event, {props, callbacks, state, context}) {\n  event.stopPropagation();\n\n  const {dragPos, dragOffset} = state;\n  state.setDragPos(null);\n  state.setDragOffset(null);\n\n  if (callbacks.onDragEnd && dragPos && dragOffset) {\n    const callbackEvent = Object.assign({}, event);\n    callbackEvent.lngLat = getDragLngLat(dragPos, dragOffset, props, context);\n    callbacks.onDragEnd(callbackEvent);\n  }\n}\n\nfunction onDragCancel(event, {state}) {\n  event.stopPropagation();\n\n  state.setDragPos(null);\n  state.setDragOffset(null);\n}\n\nfunction registerEvents(thisRef) {\n  const {eventManager} = thisRef.context;\n  if (!eventManager || !thisRef.state.dragPos) {\n    return undefined;\n  }\n\n  // panstart is already attached by parent class BaseControl,\n  // here we just add listeners for subsequent drag events\n  const events = {\n    panmove: evt => onDrag(evt, thisRef),\n    panend: evt => onDragEnd(evt, thisRef),\n    pancancel: evt => onDragCancel(evt, thisRef)\n  };\n  eventManager.watch(events);\n\n  // Clean up\n  return () => {\n    eventManager.off(events);\n  };\n}\n\nexport default function useDraggableControl(props) {\n  const [dragPos, setDragPos] = useState(null);\n  const [dragOffset, setDragOffset] = useState(null);\n\n  const thisRef = useMapControl({\n    ...props,\n    onDragStart\n  });\n\n  thisRef.callbacks = props;\n  thisRef.state.dragPos = dragPos;\n  thisRef.state.setDragPos = setDragPos;\n  thisRef.state.dragOffset = dragOffset;\n  thisRef.state.setDragOffset = setDragOffset;\n\n  useEffect(() => registerEvents(thisRef), [thisRef.context.eventManager, Boolean(dragPos)]);\n\n  return thisRef;\n}\n"]},"metadata":{},"sourceType":"script"}