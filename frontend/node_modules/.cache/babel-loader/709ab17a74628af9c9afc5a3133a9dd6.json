{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getViewport = getViewport;\nexports[\"default\"] = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar PropTypes = _interopRequireWildcard(require(\"prop-types\"));\n\nvar _viewportMercatorProject = _interopRequireDefault(require(\"viewport-mercator-project\"));\n\nvar _resizeObserverPolyfill = _interopRequireDefault(require(\"resize-observer-polyfill\"));\n\nvar _mapbox = _interopRequireDefault(require(\"../mapbox/mapbox\"));\n\nvar _mapboxgl = _interopRequireDefault(require(\"../utils/mapboxgl\"));\n\nvar _mapConstraints = require(\"../utils/map-constraints\");\n\nvar _mapState = require(\"../utils/map-state\");\n\nvar _mapContext = _interopRequireWildcard(require(\"./map-context\"));\n\nvar _useIsomorphicLayoutEffect = _interopRequireDefault(require(\"../utils/use-isomorphic-layout-effect\"));\n\nvar _terrain = require(\"../utils/terrain\");\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        (0, _defineProperty2[\"default\"])(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar TOKEN_DOC_URL = 'https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens';\nvar NO_TOKEN_WARNING = 'A valid API access token is required to use Mapbox data';\n\nfunction noop() {}\n\nfunction getViewport(_ref) {\n  var map = _ref.map,\n      props = _ref.props,\n      width = _ref.width,\n      height = _ref.height;\n\n  var viewportProps = _objectSpread(_objectSpread(_objectSpread({}, props), props.viewState), {}, {\n    width: width,\n    height: height\n  });\n\n  viewportProps.position = [0, 0, (0, _terrain.getTerrainElevation)(map, viewportProps)];\n  return new _viewportMercatorProject[\"default\"](viewportProps);\n}\n\nvar UNAUTHORIZED_ERROR_CODE = 401;\nvar CONTAINER_STYLE = {\n  position: 'absolute',\n  width: '100%',\n  height: '100%',\n  overflow: 'hidden'\n};\nvar propTypes = Object.assign({}, _mapbox[\"default\"].propTypes, {\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  onResize: PropTypes.func,\n  disableTokenWarning: PropTypes.bool,\n  visible: PropTypes.bool,\n  className: PropTypes.string,\n  style: PropTypes.object,\n  visibilityConstraints: PropTypes.object\n});\nvar defaultProps = Object.assign({}, _mapbox[\"default\"].defaultProps, {\n  disableTokenWarning: false,\n  visible: true,\n  onResize: noop,\n  className: '',\n  style: null,\n  visibilityConstraints: _mapState.MAPBOX_LIMITS\n});\n\nfunction NoTokenWarning() {\n  var style = {\n    position: 'absolute',\n    left: 0,\n    top: 0\n  };\n  return React.createElement(\"div\", {\n    key: \"warning\",\n    id: \"no-token-warning\",\n    style: style\n  }, React.createElement(\"h3\", {\n    key: \"header\"\n  }, NO_TOKEN_WARNING), React.createElement(\"div\", {\n    key: \"text\"\n  }, \"For information on setting up your basemap, read\"), React.createElement(\"a\", {\n    key: \"link\",\n    href: TOKEN_DOC_URL\n  }, \"Note on Map Tokens\"));\n}\n\nfunction getRefHandles(mapboxRef) {\n  return {\n    getMap: function getMap() {\n      return mapboxRef.current && mapboxRef.current.getMap();\n    },\n    queryRenderedFeatures: function queryRenderedFeatures(geometry) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var map = mapboxRef.current && mapboxRef.current.getMap();\n      return map && map.queryRenderedFeatures(geometry, options);\n    }\n  };\n}\n\nvar StaticMap = (0, React.forwardRef)(function (props, ref) {\n  var _useState = (0, React.useState)(true),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      accessTokenValid = _useState2[0],\n      setTokenState = _useState2[1];\n\n  var _useState3 = (0, React.useState)({\n    width: 0,\n    height: 0\n  }),\n      _useState4 = (0, _slicedToArray2[\"default\"])(_useState3, 2),\n      size = _useState4[0],\n      setSize = _useState4[1];\n\n  var mapboxRef = (0, React.useRef)(null);\n  var mapDivRef = (0, React.useRef)(null);\n  var containerRef = (0, React.useRef)(null);\n  var overlayRef = (0, React.useRef)(null);\n  var context = (0, React.useContext)(_mapContext[\"default\"]);\n  (0, _useIsomorphicLayoutEffect[\"default\"])(function () {\n    if (!StaticMap.supported()) {\n      return undefined;\n    }\n\n    var mapbox = new _mapbox[\"default\"](_objectSpread(_objectSpread(_objectSpread({}, props), size), {}, {\n      mapboxgl: _mapboxgl[\"default\"],\n      container: mapDivRef.current,\n      onError: function onError(evt) {\n        var statusCode = evt.error && evt.error.status || evt.status;\n\n        if (statusCode === UNAUTHORIZED_ERROR_CODE && accessTokenValid) {\n          console.error(NO_TOKEN_WARNING);\n          setTokenState(false);\n        }\n\n        props.onError(evt);\n      }\n    }));\n    mapboxRef.current = mapbox;\n\n    if (context && context.setMap) {\n      context.setMap(mapbox.getMap());\n    }\n\n    var resizeObserver = new _resizeObserverPolyfill[\"default\"](function (entries) {\n      if (entries[0].contentRect) {\n        var _entries$0$contentRec = entries[0].contentRect,\n            _width = _entries$0$contentRec.width,\n            _height = _entries$0$contentRec.height;\n        setSize({\n          width: _width,\n          height: _height\n        });\n        props.onResize({\n          width: _width,\n          height: _height\n        });\n      }\n    });\n    resizeObserver.observe(containerRef.current);\n    return function () {\n      mapbox.finalize();\n      mapboxRef.current = null;\n      resizeObserver.disconnect();\n    };\n  }, []);\n  (0, _useIsomorphicLayoutEffect[\"default\"])(function () {\n    if (mapboxRef.current) {\n      mapboxRef.current.setProps(_objectSpread(_objectSpread({}, props), size));\n    }\n  });\n  var map = mapboxRef.current && mapboxRef.current.getMap();\n  (0, React.useImperativeHandle)(ref, function () {\n    return getRefHandles(mapboxRef);\n  }, []);\n  var preventScroll = (0, React.useCallback)(function (_ref2) {\n    var target = _ref2.target;\n\n    if (target === overlayRef.current) {\n      target.scrollTo(0, 0);\n    }\n  }, []);\n  var overlays = map && React.createElement(_mapContext.MapContextProvider, {\n    value: _objectSpread(_objectSpread({}, context), {}, {\n      viewport: context.viewport || getViewport(_objectSpread({\n        map: map,\n        props: props\n      }, size)),\n      map: map,\n      container: context.container || containerRef.current\n    })\n  }, React.createElement(\"div\", {\n    key: \"map-overlays\",\n    className: \"overlays\",\n    ref: overlayRef,\n    style: CONTAINER_STYLE,\n    onScroll: preventScroll\n  }, props.children));\n  var className = props.className,\n      width = props.width,\n      height = props.height,\n      style = props.style,\n      visibilityConstraints = props.visibilityConstraints;\n  var mapContainerStyle = Object.assign({\n    position: 'relative'\n  }, style, {\n    width: width,\n    height: height\n  });\n  var visible = props.visible && (0, _mapConstraints.checkVisibilityConstraints)(props.viewState || props, visibilityConstraints);\n  var mapStyle = Object.assign({}, CONTAINER_STYLE, {\n    visibility: visible ? 'inherit' : 'hidden'\n  });\n  return React.createElement(\"div\", {\n    key: \"map-container\",\n    ref: containerRef,\n    style: mapContainerStyle\n  }, React.createElement(\"div\", {\n    key: \"map-mapbox\",\n    ref: mapDivRef,\n    style: mapStyle,\n    className: className\n  }), overlays, !accessTokenValid && !props.disableTokenWarning && React.createElement(NoTokenWarning, null));\n});\n\nStaticMap.supported = function () {\n  return _mapboxgl[\"default\"] && _mapboxgl[\"default\"].supported();\n};\n\nStaticMap.propTypes = propTypes;\nStaticMap.defaultProps = defaultProps;\nvar _default = StaticMap;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["D:\\Side Projects\\maptravelapp\\frontend\\node_modules\\react-map-gl\\src\\components\\static-map.js"],"names":["TOKEN_DOC_URL","NO_TOKEN_WARNING","map","props","width","height","viewportProps","WebMercatorViewport","UNAUTHORIZED_ERROR_CODE","CONTAINER_STYLE","position","overflow","propTypes","Mapbox","PropTypes","onResize","disableTokenWarning","visible","className","style","visibilityConstraints","object","defaultProps","MAPBOX_LIMITS","left","top","getMap","mapboxRef","queryRenderedFeatures","options","StaticMap","accessTokenValid","setTokenState","size","setSize","mapDivRef","containerRef","overlayRef","context","MapContext","mapbox","mapboxgl","container","onError","statusCode","evt","console","resizeObserver","ResizeObserver","entries","getRefHandles","preventScroll","target","overlays","viewport","getViewport","current","mapContainerStyle","mapStyle","visibility"],"mappings":"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","sourcesContent":["// Copyright (c) 2015 Uber Technologies, Inc.\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport * as React from 'react';\nimport {useState, useRef, useCallback, useContext, useImperativeHandle, forwardRef} from 'react';\nimport * as PropTypes from 'prop-types';\n\nimport WebMercatorViewport from 'viewport-mercator-project';\nimport ResizeObserver from 'resize-observer-polyfill';\n\nimport Mapbox from '../mapbox/mapbox';\nimport mapboxgl from '../utils/mapboxgl';\nimport {checkVisibilityConstraints} from '../utils/map-constraints';\nimport {MAPBOX_LIMITS} from '../utils/map-state';\nimport MapContext, {MapContextProvider} from './map-context';\nimport useIsomorphicLayoutEffect from '../utils/use-isomorphic-layout-effect';\nimport {getTerrainElevation} from '../utils/terrain';\n\n/* eslint-disable max-len */\nconst TOKEN_DOC_URL = 'https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens';\nconst NO_TOKEN_WARNING = 'A valid API access token is required to use Mapbox data';\n/* eslint-disable max-len */\n\nfunction noop() {}\n\nexport function getViewport({map, props, width, height}) {\n  const viewportProps = {\n    ...props,\n    ...props.viewState,\n    width,\n    height\n  };\n  viewportProps.position = [0, 0, getTerrainElevation(map, viewportProps)];\n  return new WebMercatorViewport(viewportProps);\n}\n\nconst UNAUTHORIZED_ERROR_CODE = 401;\n\nconst CONTAINER_STYLE = {\n  position: 'absolute',\n  width: '100%',\n  height: '100%',\n  overflow: 'hidden'\n};\n\nconst propTypes = Object.assign({}, Mapbox.propTypes, {\n  /** The dimensions of the map **/\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n\n  /** Callback when map size changes **/\n  onResize: PropTypes.func,\n  /** Hide invalid token warning even if request fails */\n  disableTokenWarning: PropTypes.bool,\n  /** Whether the map is visible */\n  visible: PropTypes.bool,\n  /** Custom class name for the map */\n  className: PropTypes.string,\n  /** Custom CSS for the container */\n  style: PropTypes.object,\n\n  /** Advanced features */\n  // Contraints for displaying the map. If not met, then the map is hidden.\n  // Experimental! May be changed in minor version updates.\n  visibilityConstraints: PropTypes.object\n});\n\nconst defaultProps = Object.assign({}, Mapbox.defaultProps, {\n  disableTokenWarning: false,\n  visible: true,\n  onResize: noop,\n  className: '',\n  style: null,\n  visibilityConstraints: MAPBOX_LIMITS\n});\n\nfunction NoTokenWarning() {\n  const style = {\n    position: 'absolute',\n    left: 0,\n    top: 0\n  };\n  return (\n    <div\n      key=\"warning\"\n      id=\"no-token-warning\"\n      // @ts-ignore\n      style={style}\n    >\n      <h3 key=\"header\">{NO_TOKEN_WARNING}</h3>\n      <div key=\"text\">For information on setting up your basemap, read</div>\n      <a key=\"link\" href={TOKEN_DOC_URL}>\n        Note on Map Tokens\n      </a>\n    </div>\n  );\n}\n\nfunction getRefHandles(mapboxRef) {\n  return {\n    getMap: () => mapboxRef.current && mapboxRef.current.getMap(),\n    queryRenderedFeatures: (geometry, options = {}) => {\n      const map = mapboxRef.current && mapboxRef.current.getMap();\n      return map && map.queryRenderedFeatures(geometry, options);\n    }\n  };\n}\n\nconst StaticMap = forwardRef((props, ref) => {\n  const [accessTokenValid, setTokenState] = useState(true);\n  const [size, setSize] = useState({width: 0, height: 0});\n  const mapboxRef = useRef(null);\n  const mapDivRef = useRef(null);\n  const containerRef = useRef(null);\n  const overlayRef = useRef(null);\n  const context = useContext(MapContext);\n\n  useIsomorphicLayoutEffect(() => {\n    if (!StaticMap.supported()) {\n      return undefined;\n    }\n\n    // Initialize\n    const mapbox = new Mapbox({\n      ...props,\n      ...size,\n      mapboxgl, // Handle to mapbox-gl library\n      container: mapDivRef.current,\n      onError: evt => {\n        const statusCode = (evt.error && evt.error.status) || evt.status;\n        if (statusCode === UNAUTHORIZED_ERROR_CODE && accessTokenValid) {\n          // Mapbox throws unauthorized error - invalid token\n          console.error(NO_TOKEN_WARNING); // eslint-disable-line\n          setTokenState(false);\n        }\n        props.onError(evt);\n      }\n    });\n    mapboxRef.current = mapbox;\n\n    if (context && context.setMap) {\n      context.setMap(mapbox.getMap());\n    }\n\n    const resizeObserver = new ResizeObserver(entries => {\n      if (entries[0].contentRect) {\n        const {width, height} = entries[0].contentRect;\n        setSize({width, height});\n        props.onResize({width, height});\n      }\n    });\n    resizeObserver.observe(containerRef.current);\n\n    // Clean up\n    return () => {\n      mapbox.finalize();\n      mapboxRef.current = null;\n      resizeObserver.disconnect();\n    };\n  }, []);\n\n  useIsomorphicLayoutEffect(() => {\n    if (mapboxRef.current) {\n      mapboxRef.current.setProps({...props, ...size});\n    }\n  });\n\n  const map = mapboxRef.current && mapboxRef.current.getMap();\n\n  // External apps can call methods via ref\n  // Note: this is not a recommended pattern in React FC - Keeping for backward compatibility\n  useImperativeHandle(ref, () => getRefHandles(mapboxRef), []);\n\n  const preventScroll = useCallback(({target}) => {\n    if (target === overlayRef.current) {\n      target.scrollTo(0, 0);\n    }\n  }, []);\n\n  const overlays = map && (\n    <MapContextProvider\n      value={{\n        ...context,\n        viewport: context.viewport || getViewport({map, props, ...size}),\n        map,\n        container: context.container || containerRef.current\n      }}\n    >\n      <div\n        key=\"map-overlays\"\n        className=\"overlays\"\n        ref={overlayRef}\n        // @ts-ignore\n        style={CONTAINER_STYLE}\n        onScroll={preventScroll}\n      >\n        {props.children}\n      </div>\n    </MapContextProvider>\n  );\n\n  const {className, width, height, style, visibilityConstraints} = props;\n  const mapContainerStyle = Object.assign({position: 'relative'}, style, {\n    width,\n    height\n  });\n\n  const visible =\n    props.visible && checkVisibilityConstraints(props.viewState || props, visibilityConstraints);\n\n  const mapStyle = Object.assign({}, CONTAINER_STYLE, {\n    visibility: visible ? 'inherit' : 'hidden'\n  });\n\n  return (\n    <div\n      key=\"map-container\"\n      ref={containerRef}\n      // @ts-ignore\n      style={mapContainerStyle}\n    >\n      <div\n        key=\"map-mapbox\"\n        ref={mapDivRef}\n        // @ts-ignore\n        style={mapStyle}\n        className={className}\n      />\n      {overlays}\n      {!accessTokenValid && !props.disableTokenWarning && <NoTokenWarning />}\n    </div>\n  );\n});\n\nStaticMap.supported = () => mapboxgl && mapboxgl.supported();\nStaticMap.propTypes = propTypes;\nStaticMap.defaultProps = defaultProps;\n\nexport default StaticMap;\n"]},"metadata":{},"sourceType":"script"}