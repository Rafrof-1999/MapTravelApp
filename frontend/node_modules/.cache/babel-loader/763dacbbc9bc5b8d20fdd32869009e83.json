{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar PropTypes = _interopRequireWildcard(require(\"prop-types\"));\n\nvar _mapContext = _interopRequireDefault(require(\"./map-context\"));\n\nvar _assert = _interopRequireDefault(require(\"../utils/assert\"));\n\nvar _deepEqual = _interopRequireDefault(require(\"../utils/deep-equal\"));\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        (0, _defineProperty2[\"default\"])(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar propTypes = {\n  type: PropTypes.string.isRequired,\n  id: PropTypes.string\n};\nvar sourceCounter = 0;\n\nfunction createSource(map, id, props) {\n  if (map.style && map.style._loaded) {\n    var options = _objectSpread({}, props);\n\n    delete options.id;\n    delete options.children;\n    map.addSource(id, options);\n    return map.getSource(id);\n  }\n\n  return null;\n}\n\nfunction updateSource(source, props, prevProps) {\n  (0, _assert[\"default\"])(props.id === prevProps.id, 'source id changed');\n  (0, _assert[\"default\"])(props.type === prevProps.type, 'source type changed');\n  var changedKey = '';\n  var changedKeyCount = 0;\n\n  for (var key in props) {\n    if (key !== 'children' && key !== 'id' && !(0, _deepEqual[\"default\"])(prevProps[key], props[key])) {\n      changedKey = key;\n      changedKeyCount++;\n    }\n  }\n\n  if (!changedKeyCount) {\n    return;\n  }\n\n  var type = props.type;\n\n  if (type === 'geojson') {\n    source.setData(props.data);\n  } else if (type === 'image') {\n    source.updateImage({\n      url: props.url,\n      coordinates: props.coordinates\n    });\n  } else if ((type === 'canvas' || type === 'video') && changedKeyCount === 1 && changedKey === 'coordinates') {\n    source.setCoordinates(props.coordinates);\n  } else if (type === 'vector' && source.setUrl) {\n    switch (changedKey) {\n      case 'url':\n        source.setUrl(props.url);\n        break;\n\n      case 'tiles':\n        source.setTiles(props.tiles);\n        break;\n\n      default:\n    }\n  } else {\n    console.warn(\"Unable to update <Source> prop: \".concat(changedKey));\n  }\n}\n\nfunction Source(props) {\n  var context = (0, React.useContext)(_mapContext[\"default\"]);\n  var propsRef = (0, React.useRef)({\n    id: props.id,\n    type: props.type\n  });\n\n  var _useState = (0, React.useState)(0),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      setStyleLoaded = _useState2[1];\n\n  var id = (0, React.useMemo)(function () {\n    return props.id || \"jsx-source-\".concat(sourceCounter++);\n  }, []);\n  var map = context.map;\n  (0, React.useEffect)(function () {\n    if (map) {\n      var forceUpdate = function forceUpdate() {\n        return setStyleLoaded(function (version) {\n          return version + 1;\n        });\n      };\n\n      map.on('styledata', forceUpdate);\n      return function () {\n        map.off('styledata', forceUpdate);\n        requestAnimationFrame(function () {\n          if (map.style && map.style._loaded && map.getSource(id)) {\n            map.removeSource(id);\n          }\n        });\n      };\n    }\n\n    return undefined;\n  }, [map, id]);\n  var source = map && map.style && map.getSource(id);\n\n  if (source) {\n    updateSource(source, props, propsRef.current);\n  } else {\n    source = createSource(map, id, props);\n  }\n\n  propsRef.current = props;\n  return source && React.Children.map(props.children, function (child) {\n    return child && (0, React.cloneElement)(child, {\n      source: id\n    });\n  }) || null;\n}\n\nSource.propTypes = propTypes;\nvar _default = Source;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["D:\\Side Projects\\maptravelapp\\frontend\\node_modules\\react-map-gl\\src\\components\\source.js"],"names":["propTypes","type","PropTypes","id","string","sourceCounter","map","options","props","prevProps","changedKey","changedKeyCount","key","source","url","coordinates","console","context","MapContext","propsRef","setStyleLoaded","forceUpdate","version","requestAnimationFrame","updateSource","createSource","child","Source"],"mappings":";;;;;;;;;;;;;;;AAmBA,IAAA,KAAA,GAAA,uBAAA,CAAA,OAAA,CAAA,OAAA,CAAA,CAAA;;AAGA,IAAA,SAAA,GAAA,uBAAA,CAAA,OAAA,CAAA,YAAA,CAAA,CAAA;;AACA,IAAA,WAAA,GAAA,sBAAA,CAAA,OAAA,CAAA,eAAA,CAAA,CAAA;;AACA,IAAA,OAAA,GAAA,sBAAA,CAAA,OAAA,CAAA,iBAAA,CAAA,CAAA;;AACA,IAAA,UAAA,GAAA,sBAAA,CAAA,OAAA,CAAA,qBAAA,CAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAMA,SAAS,GAAG;AAChBC,EAAAA,IAAI,EAAEC,SAAS,CAATA,MAAAA,CADU,UAAA;AAEhBC,EAAAA,EAAE,EAAED,SAAS,CAACE;AAFE,CAAlB;AAKA,IAAIC,aAAa,GAAjB,CAAA;;AAEA,SAAA,YAAA,CAAA,GAAA,EAAA,EAAA,EAAA,KAAA,EAAsC;AACpC,MAAIC,GAAG,CAAHA,KAAAA,IAAaA,GAAG,CAAHA,KAAAA,CAAjB,OAAA,EAAoC;AAClC,QAAMC,OAAO,GAAA,aAAA,CAAA,EAAA,EAAb,KAAa,CAAb;;AACA,WAAOA,OAAO,CAAd,EAAA;AACA,WAAOA,OAAO,CAAd,QAAA;AACAD,IAAAA,GAAG,CAAHA,SAAAA,CAAAA,EAAAA,EAAAA,OAAAA;AACA,WAAOA,GAAG,CAAHA,SAAAA,CAAP,EAAOA,CAAP;AACD;;AACD,SAAA,IAAA;AACD;;AAGD,SAAA,YAAA,CAAA,MAAA,EAAA,KAAA,EAAA,SAAA,EAAgD;AAC9C,GAAA,GAAA,OAAA,CAAA,SAAA,CAAA,EAAOE,KAAK,CAALA,EAAAA,KAAaC,SAAS,CAA7B,EAAA,EAAA,mBAAA;AACA,GAAA,GAAA,OAAA,CAAA,SAAA,CAAA,EAAOD,KAAK,CAALA,IAAAA,KAAeC,SAAS,CAA/B,IAAA,EAAA,qBAAA;AAEA,MAAIC,UAAU,GAAd,EAAA;AACA,MAAIC,eAAe,GAAnB,CAAA;;AAEA,OAAK,IAAL,GAAA,IAAA,KAAA,EAAyB;AACvB,QAAIC,GAAG,KAAHA,UAAAA,IAAsBA,GAAG,KAAzBA,IAAAA,IAAsC,CAAC,CAAA,GAAA,UAAA,CAAA,SAAA,CAAA,EAAUH,SAAS,CAAnB,GAAmB,CAAnB,EAA0BD,KAAK,CAA1E,GAA0E,CAA/B,CAA3C,EAAkF;AAChFE,MAAAA,UAAU,GAAVA,GAAAA;AACAC,MAAAA,eAAe;AAChB;AACF;;AAED,MAAI,CAAJ,eAAA,EAAsB;AACpB;AACD;;AAhB6C,MAkBvCV,IAlBuC,GAkB/BO,KAlB+B,CAAA,IAAA;;AAmB9C,MAAIP,IAAI,KAAR,SAAA,EAAwB;AACtBY,IAAAA,MAAM,CAANA,OAAAA,CAAeL,KAAK,CAApBK,IAAAA;AADF,GAAA,MAEO,IAAIZ,IAAI,KAAR,OAAA,EAAsB;AAC3BY,IAAAA,MAAM,CAANA,WAAAA,CAAmB;AAACC,MAAAA,GAAG,EAAEN,KAAK,CAAX,GAAA;AAAiBO,MAAAA,WAAW,EAAEP,KAAK,CAACO;AAApC,KAAnBF;AADK,GAAA,MAEA,IACL,CAACZ,IAAI,KAAJA,QAAAA,IAAqBA,IAAI,KAA1B,OAAA,KACAU,eAAe,KADf,CAAA,IAEAD,UAAU,KAHL,aAAA,EAIL;AACAG,IAAAA,MAAM,CAANA,cAAAA,CAAsBL,KAAK,CAA3BK,WAAAA;AALK,GAAA,MAMA,IAAIZ,IAAI,KAAJA,QAAAA,IAAqBY,MAAM,CAA/B,MAAA,EAAwC;AAI7C,YAAA,UAAA;AACE,WAAA,KAAA;AACEA,QAAAA,MAAM,CAANA,MAAAA,CAAcL,KAAK,CAAnBK,GAAAA;AACA;;AACF,WAAA,OAAA;AACEA,QAAAA,MAAM,CAANA,QAAAA,CAAgBL,KAAK,CAArBK,KAAAA;AACA;;AACF;AAPF;AAJK,GAAA,MAaA;AAELG,IAAAA,OAAO,CAAPA,IAAAA,CAAAA,mCAAAA,MAAAA,CAAAA,UAAAA,CAAAA;AACD;AACF;;AAGD,SAAA,MAAA,CAAA,KAAA,EAAuB;AACrB,MAAMC,OAAO,GAAG,CAAA,GAAA,KAAA,CAAA,UAAA,EAAWC,WAAAA,CAA3B,SAA2BA,CAAX,CAAhB;AACA,MAAMC,QAAQ,GAAG,CAAA,GAAA,KAAA,CAAA,MAAA,EAAO;AAAChB,IAAAA,EAAE,EAAEK,KAAK,CAAV,EAAA;AAAeP,IAAAA,IAAI,EAAEO,KAAK,CAACP;AAA3B,GAAP,CAAjB;;AAFqB,MAAA,SAAA,GAGM,CAAA,GAAA,KAAA,CAAA,QAAA,EAHN,CAGM,CAHN;AAAA,MAAA,UAAA,GAAA,CAAA,GAAA,eAAA,CAAA,SAAA,CAAA,EAAA,SAAA,EAAA,CAAA,CAAA;AAAA,MAGZmB,cAHY,GAAA,UAAA,CAAA,CAAA,CAAA;;AAKrB,MAAMjB,EAAE,GAAG,CAAA,GAAA,KAAA,CAAA,OAAA,EAAQ,YAAA;AAAA,WAAMK,KAAK,CAALA,EAAAA,IAAAA,cAAAA,MAAAA,CAA0BH,aAAhC,EAAMG,CAAN;AAAR,GAAA,EAAX,EAAW,CAAX;AALqB,MAMdF,GANc,GAMPW,OANO,CAAA,GAAA;AAQrB,GAAA,GAAA,KAAA,CAAA,SAAA,EAAU,YAAM;AACd,QAAA,GAAA,EAAS;AACP,UAAMI,WAAW,GAAG,SAAdA,WAAc,GAAA;AAAA,eAAMD,cAAc,CAAC,UAAA,OAAA,EAAO;AAAA,iBAAIE,OAAO,GAAX,CAAA;AAA5B,SAAoB,CAApB;AAApB,OAAA;;AACAhB,MAAAA,GAAG,CAAHA,EAAAA,CAAAA,WAAAA,EAAAA,WAAAA;AAEA,aAAO,YAAM;AACXA,QAAAA,GAAG,CAAHA,GAAAA,CAAAA,WAAAA,EAAAA,WAAAA;AAMAiB,QAAAA,qBAAqB,CAAC,YAAM;AAC1B,cAAIjB,GAAG,CAAHA,KAAAA,IAAaA,GAAG,CAAHA,KAAAA,CAAbA,OAAAA,IAAkCA,GAAG,CAAHA,SAAAA,CAAtC,EAAsCA,CAAtC,EAAyD;AACvDA,YAAAA,GAAG,CAAHA,YAAAA,CAAAA,EAAAA;AACD;AAHHiB,SAAqB,CAArBA;AAPF,OAAA;AAaD;;AACD,WAAA,SAAA;AAnBF,GAAA,EAoBG,CAAA,GAAA,EApBH,EAoBG,CApBH;AAsBA,MAAIV,MAAM,GAAGP,GAAG,IAAIA,GAAG,CAAVA,KAAAA,IAAoBA,GAAG,CAAHA,SAAAA,CAAjC,EAAiCA,CAAjC;;AACA,MAAA,MAAA,EAAY;AACVkB,IAAAA,YAAY,CAAA,MAAA,EAAA,KAAA,EAAgBL,QAAQ,CAApCK,OAAY,CAAZA;AADF,GAAA,MAEO;AACLX,IAAAA,MAAM,GAAGY,YAAY,CAAA,GAAA,EAAA,EAAA,EAArBZ,KAAqB,CAArBA;AACD;;AACDM,EAAAA,QAAQ,CAARA,OAAAA,GAAAA,KAAAA;AAEA,SACGN,MAAM,IACL,KAAK,CAAL,QAAA,CAAA,GAAA,CACEL,KAAK,CADP,QAAA,EAEE,UAAA,KAAA,EAAK;AAAA,WACHkB,KAAK,IACL,CAAA,GAAA,KAAA,CAAA,YAAA,EAAA,KAAA,EAAoB;AAClBb,MAAAA,MAAM,EAAEV;AADU,KAApB,CAFG;AAHT,GACE,CADDU,IADH,IAAA;AAYD;;AAEDc,MAAM,CAANA,SAAAA,GAAAA,SAAAA;eACeA,M","sourcesContent":["// Copyright (c) 2015 Uber Technologies, Inc.\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport * as React from 'react';\nimport {useContext, useEffect, useMemo, useState, useRef} from 'react';\nimport {cloneElement} from 'react';\nimport * as PropTypes from 'prop-types';\nimport MapContext from './map-context';\nimport assert from '../utils/assert';\nimport deepEqual from '../utils/deep-equal';\n\nconst propTypes = {\n  type: PropTypes.string.isRequired,\n  id: PropTypes.string\n};\n\nlet sourceCounter = 0;\n\nfunction createSource(map, id, props) {\n  if (map.style && map.style._loaded) {\n    const options = {...props};\n    delete options.id;\n    delete options.children;\n    map.addSource(id, options);\n    return map.getSource(id);\n  }\n  return null;\n}\n\n/* eslint-disable complexity */\nfunction updateSource(source, props, prevProps) {\n  assert(props.id === prevProps.id, 'source id changed');\n  assert(props.type === prevProps.type, 'source type changed');\n\n  let changedKey = '';\n  let changedKeyCount = 0;\n\n  for (const key in props) {\n    if (key !== 'children' && key !== 'id' && !deepEqual(prevProps[key], props[key])) {\n      changedKey = key;\n      changedKeyCount++;\n    }\n  }\n\n  if (!changedKeyCount) {\n    return;\n  }\n\n  const {type} = props;\n  if (type === 'geojson') {\n    source.setData(props.data);\n  } else if (type === 'image') {\n    source.updateImage({url: props.url, coordinates: props.coordinates});\n  } else if (\n    (type === 'canvas' || type === 'video') &&\n    changedKeyCount === 1 &&\n    changedKey === 'coordinates'\n  ) {\n    source.setCoordinates(props.coordinates);\n  } else if (type === 'vector' && source.setUrl) {\n    // Added in 1.12.0:\n    // vectorTileSource.setTiles\n    // vectorTileSource.setUrl\n    switch (changedKey) {\n      case 'url':\n        source.setUrl(props.url);\n        break;\n      case 'tiles':\n        source.setTiles(props.tiles);\n        break;\n      default:\n    }\n  } else {\n    // eslint-disable-next-line\n    console.warn(`Unable to update <Source> prop: ${changedKey}`);\n  }\n}\n/* eslint-enable complexity */\n\nfunction Source(props) {\n  const context = useContext(MapContext);\n  const propsRef = useRef({id: props.id, type: props.type});\n  const [, setStyleLoaded] = useState(0);\n\n  const id = useMemo(() => props.id || `jsx-source-${sourceCounter++}`, []);\n  const {map} = context;\n\n  useEffect(() => {\n    if (map) {\n      const forceUpdate = () => setStyleLoaded(version => version + 1);\n      map.on('styledata', forceUpdate);\n\n      return () => {\n        map.off('styledata', forceUpdate);\n        /* global requestAnimationFrame */\n        // Do not remove source immediately because the\n        // dependent <Layer>s' componentWillUnmount() might not have been called\n        // Removing source before dependent layers will throw error\n        // TODO - find a more robust solution\n        requestAnimationFrame(() => {\n          if (map.style && map.style._loaded && map.getSource(id)) {\n            map.removeSource(id);\n          }\n        });\n      };\n    }\n    return undefined;\n  }, [map, id]);\n\n  let source = map && map.style && map.getSource(id);\n  if (source) {\n    updateSource(source, props, propsRef.current);\n  } else {\n    source = createSource(map, id, props);\n  }\n  propsRef.current = props;\n\n  return (\n    (source &&\n      React.Children.map(\n        props.children,\n        child =>\n          child &&\n          cloneElement(child, {\n            source: id\n          })\n      )) ||\n    null\n  );\n}\n\nSource.propTypes = propTypes;\nexport default Source;\n"]},"metadata":{},"sourceType":"script"}